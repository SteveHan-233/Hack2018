{"remainingRequest":"/Users/timothyqin/ONE/hackathon/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/timothyqin/ONE/hackathon/src/components/Bank.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/timothyqin/ONE/hackathon/src/components/Bank.vue","mtime":1561324123158},{"path":"/Users/timothyqin/ONE/hackathon/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/timothyqin/ONE/hackathon/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/timothyqin/ONE/hackathon/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/timothyqin/ONE/hackathon/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n(function($) {\n    var products = '<%= PLAID_PRODUCTS %>'.split(',');\n    if (products.includes('assets')) {\n        $('#assets').show();\n    }\n\n    var handler = Plaid.create({\n        apiVersion: 'v2',\n        clientName: 'Plaid Quickstart',\n        env: '<%= PLAID_ENV %>',\n        product: products,\n        key: '<%= PLAID_PUBLIC_KEY %>',\n        countryCodes: '<%= PLAID_COUNTRY_CODES %>'.split(','),\n        // webhook: 'https://your-domain.tld/plaid-webhook',\n        onSuccess: function(public_token) {\n            $.post('/get_access_token', {\n                public_token: public_token\n            }, function(data) {\n                $('#container').fadeOut('fast', function() {\n                    $('#item_id').text(data.item_id);\n                    $('#access_token').text(data.access_token);\n                    $('#intro').hide();\n                    $('#app, #steps').fadeIn('slow');\n                });\n            });\n        },\n    });\n    var accessToken = qs('access_token');\n    if (accessToken != null && accessToken != '') {\n        $.post('/set_access_token', {\n            access_token: accessToken\n        }, function(data) {\n            $('#container').fadeOut('fast', function() {\n                $('#item_id').text(data.item_id);\n                $('#access_token').text(accessToken);\n                $('#intro').hide();\n                $('#app, #steps').fadeIn('slow');\n            });\n        });\n    }\n\n    $('#link-btn').on('click', function(e) {\n        handler.open();\n    });\n\n    $('#get-accounts-btn').on('click', function(e) {\n        $.get('/accounts', function(data) {\n\n            $('#get-accounts-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                var html = '<tr><td><strong>Name</strong></td><td><strong>Balances</strong></td><td><strong>Subtype</strong></td><td><strong>Mask</strong></td></tr>';\n                data.accounts.accounts.forEach(function(account, idx) {\n                    console.log(account);\n                    html += '<tr>';\n                    html += '<td>' + account.name + '</td>';\n                    html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>';\n                    html += '<td>' + account.subtype + '</td>';\n                    html += '<td>' + account.mask + '</td>';\n                    html += '</tr>';\n                });\n\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n\n    $('#get-auth-btn').on('click', function(e) {\n        $.get('/auth', function(data) {\n            $('#get-auth-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                var authData = data.auth;\n                var isAch = authData.numbers.ach.length > 0;\n                var routingLabel = isAch ? 'Routing #' : 'Institution and Branch #';\n\n                var html = '<tr><td><strong>Name</strong></td><td><strong>Balance</strong></td><td><strong>Account #</strong></td><td><strong>'+ routingLabel +'</strong></td></tr>';\n                if (isAch) {\n                    authData.numbers.ach.forEach(function(achNumbers, idx) {\n                        // Find the account associated with this set of account and routing numbers\n                        var account = authData.accounts.filter(function(a) {\n                            return a.account_id == achNumbers.account_id;\n                        })[0];\n                        console.log(account);\n                        html += '<tr>';\n                        html += '<td>' + account.name + '</td>';\n                        html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>';\n                        html += '<td>' + achNumbers.account + '</td>';\n                        html += '<td>' + achNumbers.routing + '</td>';\n                        html += '</tr>';\n                    });\n                } else {\n                    authData.numbers.eft.forEach(function(eftNumber, idx) {\n                        // Find the account associated with this set of account and routing numbers\n                        var account = authData.accounts.filter(function(a) {\n                            return a.account_id == eftNumber.account_id;\n                        })[0];\n                        console.log(account);\n                        html += '<tr>';\n                        html += '<td>' + account.name + '</td>';\n                        html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>';\n                        html += '<td>' + eftNumber.account + '</td>';\n                        html += '<td>' + eftNumber.institution + ' ' + eftNumber.branch + '</td>';\n                        html += '</tr>';\n                    });\n                }\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n\n    $('#get-identity-btn').on('click', function(e) {\n        $.get('/identity', function(data) {\n            $('#get-identity-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                var identityData = data.identity.identity;\n                var html = '<tr class=\"response-row response-row--is-identity\"><td><strong>Names</strong></td><td><strong>Emails</strong></td><td><strong>Phone numbers</strong></td><td><strong>Addresses</strong></td></tr><tr class=\"response-row response-row--is-identity\">';\n                html += '<td>';\n                identityData.names.forEach(function(name, idx) {\n                    html += name + '<br />';\n                });\n                html += '</td><td>';\n                identityData.emails.forEach(function(email, idx) {\n                    html += email.data + '<br />';\n                });\n                html += '</td><td>';\n                identityData.phone_numbers.forEach(function(number, idx) {\n                    html += number.data + '<br />';\n                });\n                html += '</td><td>';\n                identityData.addresses.forEach(function(address, idx) {\n                    html += address.data.street + '<br />';\n                    html += address.data.city + ', ' + address.data.state + ' ' + address.data.zip;\n                });\n                html += '</td></tr>';\n\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n\n    $('#get-item-btn').on('click', function(e) {\n        $.get('/item', function(data) {\n            $('#get-item-data').slideUp(function() {\n                if (data.error) {\n                    displayError(this, data.error);\n                } else {\n                    var html = '';\n                    html += '<tr><td>Institution name</td><td>' + data.institution.name + '</td></tr>';\n                    html += '<tr><td>Billed products</td><td>' + data.item.billed_products.join(', ') + '</td></tr>';\n                    html += '<tr><td>Available products</td><td>' + data.item.available_products.join(', ') + '</td></tr>';\n\n                    $(this).html(html).slideDown();\n                }\n            });\n        });\n    });\n\n    $('#get-transactions-btn').on('click', function(e) {\n        $.get('/transactions', function(data) {\n            if (data.error != null && data.error.error_code != null) {\n                // Format the error\n                var errorHtml = '<div class=\"inner\"><p>' +\n                    '<strong>' + data.error.error_code + ':</strong> ' +\n                    (data.error.display_message == null ? data.error.error_message : data.error.display_message)  + '</p></div>';\n\n                if (data.error.error_code === 'PRODUCT_NOT_READY') {\n                    // Add additional context for `PRODUCT_NOT_READY` errors\n                    errorHtml += '<div class=\"inner\"><p>Note: The PRODUCT_NOT_READY ' +\n                        'error is returned when a request to retrieve Transaction data ' +\n                        'is made before Plaid finishes the <a href=\"https://plaid.com/' +\n                        'docs/quickstart/#transaction-data-with-webhooks\">initial ' +\n                        'transaction pull.</a></p></div>';\n                }\n                // Render the error\n                $('#get-transactions-data').slideUp(function() {\n                    $(this).slideUp(function() {\n                        $(this).html(errorHtml).slideDown();\n                    });\n                });\n            } else {\n                $('#get-transactions-data').slideUp(function() {\n                    var html = '<tr><td><strong>Name</strong></td><td><strong>Amount</strong></td><td><strong>Date</strong></td></tr>';\n                    data.transactions.transactions.forEach(function(txn, idx) {\n                        console.log(txn);\n                        html += '<tr>';\n                        html += '<td>' + txn.name + '</td>';\n                        html += '<td>$' + txn.amount + '</td>';\n                        html += '<td>' + txn.date + '</td>';\n                        html += '</tr>';\n                    });\n\n                    $(this).slideUp(function() {\n                        $(this).html(html).slideDown();\n                    });\n                });\n            }\n        });\n    });\n\n    $('#get-balance-btn').on('click', function(e) {\n        $.get('/balance', function(data) {\n            $('#get-balance-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                var balanceData = data.balance;\n                var html = '<tr><td><strong>Name</strong></td><td><strong>Balance</strong></td><td><strong>Subtype</strong></td><td><strong>Mask</strong></td></tr>';\n                balanceData.accounts.forEach(function(account, idx) {\n                    console.log(account)\n                    html += '<tr>';\n                    html += '<td>' + account.name + '</td>';\n                    html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>'\n                    html += '<td>' + account.subtype + '</td>';\n                    html += '<td>' + account.mask + '</td>';\n                    html += '</tr>';\n                });\n\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n\n    $('#get-holdings-btn').on('click', function(e) {\n        $.get('/holdings', function(data) {\n            $('#get-holdings-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                // Organize by Account\n                var holdingsData = data.holdings.holdings.sort(function(a, b) {\n                    if (a.account_id > b.account_id) return 1;\n                    return -1;\n                });\n                var html = '<tr class=\"response-row response-row--is-holdings\"></tr><td><strong>Account Mask</strong></td><td><strong>Name</strong></td><td><strong>Quantity</strong></td><td><strong>Close Price</strong></td><td><strong>Value</strong></td><tr class=\"response-row response-row--is-holding\">';\n                holdingsData.forEach(function(h, idx) {\n                    const account = data.holdings.accounts.filter(a => a.account_id === h.account_id)[0];\n                    const security = data.holdings.securities.filter(s => s.security_id === h.security_id)[0];\n                    if (account == null) {\n                        displayError(this, {\n                            code: 500,\n                            type: 'Internal',\n                            display_message: 'Holding lacks a account',\n                        });\n                    }\n                    if (security == null) {\n                        displayError(this, {\n                            code: 500,\n                            type: 'Internal',\n                            display_message: 'Holding lacks a security',\n                        });\n                    }\n                    html += '<tr>';\n                    html += '<td>' + account.mask + '</td>';\n                    html += '<td>' + security.name + '</td>';\n                    html += '<td>' + h.quantity + '</td>';\n                    html += '<td>$' + security.close_price + '</td>';\n                    html += '<td>$' + h.quantity * security.close_price + '</td>';\n                    html += '</tr>';\n                });\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n\n    $('#get-investment-transactions-btn').on('click', function(e) {\n        $.get('/investment_transactions', function(data) {\n            $('#get-investment-transactions-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                investmentTransactionData = data.investment_transactions.investment_transactions;\n                var html = '<tr class=\"response-row response-row--is-investment-transactions\"></tr><td><strong>Name</strong></td><td><strong>Amount</strong></td><td><strong>Date</strong></td><tr class=\"response-row response-row--is-investment-transaction\">';\n                investmentTransactionData.forEach(function(invTxn, idx) {\n                    html += '<tr>';\n                    html += '<td>' + invTxn.name + '</td>';\n                    html += '<td>$' + invTxn.amount + '</td>';\n                    html += '<td>' + invTxn.date + '</td>';\n                    html += '</tr>';\n                });\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n\n    $('#get-assets-btn').on('click', function(e) {\n        $.get('/assets', function(data) {\n            $('#get-assets-data').slideUp(function() {\n                if (data.error != null) {\n                    displayError(this, data.error);\n                    return;\n                }\n                var reportData = data.json;\n                var html = `\n      <tr>\n        <td><strong>Account</strong></td>\n        <td><strong>Balance</strong></td>\n        <td><strong># Transactions</strong></td>\n        <td><strong># Days Available</strong></td>\n      </tr>`;\n                reportData.items.forEach(function(item, itemIdx) {\n                    item.accounts.forEach(function(account, accountIdx) {\n                        html += '<tr>';\n                        html += '<td>' + account.name + '</td>';\n                        html += '<td>$' + account.balances.current + '</td>'\n                        html += '<td>' + account.transactions.length + '</td>';\n                        html += '<td>' + account.days_available + '</td>';\n                        html += '</tr>';\n                    });\n                });\n\n                $('#download-assets-pdf-btn')\n                    .attr('href', `data:application/pdf;base64,${data.pdf}`)\n                    .attr('download', 'Asset Report.pdf')\n                    .show();\n\n                $(this).html(html).slideDown();\n            });\n        });\n    });\n})(jQuery);\n\nfunction qs(key) {\n    key = key.replace(/[*+?^$.\\[\\]{}()|\\\\\\/]/g, \"\\\\$&\"); // escape RegEx meta chars\n    var match = location.search.match(new RegExp(\"[?&]\"+key+\"=([^&]+)(&|$)\"));\n    return match && decodeURIComponent(match[1].replace(/\\+/g, \" \"));\n}\n\nfunction displayError(element, error) {\n    var html = `\n<div class=\"alert alert-danger\">\n  <p><strong>Error Code:</strong> ${error.error_code}</p>\n  <p><strong>Error Type:</strong> ${error.error_type}</p>\n  <p><strong>Error Message:</strong> ${error.display_message == null ? error.error_message : error.display_message}</p>\n  <div>Check out our <a href=\"https://plaid.com/docs/#errors-overview\">errors documentation</a> for more information.</div>\n</div>`;\n    $(element).html(html).slideDown();\n}\n",{"version":3,"sources":["Bank.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4NA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Bank.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <main class=\"main\">\n        <div class=\"grid\">\n            <div class=\"grid__column grid__column--is-twelve-columns\">\n                <div id=\"banner\" class=\"everpresent-content\">\n                    <h1 class=\"everpresent-content__heading\">Plaid Quickstart</h1>\n                    <p id=\"intro\" class=\"everpresent-content__subheading\">\n                        An example application that outlines an end-to-end integration with Plaid\n                    </p>\n                    <p id=\"steps\" class=\"everpresent-content__subheading\">\n                        Success! You just created an Item by linking your account.\n                    </p>\n                </div>\n\n                <div id=\"container\" class=\"initial-view\">\n                    <p class=\"initial-view__description\">\n                        Click the button below to open a list of Institutions. After you select one, you’ll be guided through an authentication process. Upon completion, a public_token will be passed back to the server and exchanged for access_token.\n                    </p>\n\n                    <button id=\"link-btn\" class=\"button button--is-primary\">Connect with Plaid</button>\n                </div>\n\n                <div id=\"app\" class=\"connected-view\">\n                    <div class=\"item-overview\">\n                        <div class=\"item-overview__column\">\n                            <h3 class=\"item-overview__heading\">item_id</h3>\n                            <p class=\"item-overview__id\" id=\"item_id\">san.asjsansakjsakjasjksajkas</p>\n                        </div>\n                        <div class=\"item-overview__column\">\n                            <h3 class=\"item-overview__heading\">access_token</h3>\n                            <p class=\"item-overview__id\" id=\"access_token\">••••••••hsakjsl</p>\n                        </div>\n\n                        <div style=\"clear: both\"></div>\n                    </div>\n\n                    <p>Now that you have an access_token you can make all of the following API requests:</p>\n\n                    <div class=\"box\">\n                        <h3 class=\"box__heading\">Products</h3>\n\n                        <!-- Auth -->\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Auth</div>\n                                <div class=\"item-data-row__endpoint\">/auth/get</div>\n                                <div class=\"item-data-row__description\">Retrieve account and routing numbers for checking and savings accounts.</div>\n                            </div>\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-auth-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-auth-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                        <!--Transactions -->\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Transactions</div>\n                                <div class=\"item-data-row__endpoint\">/transactions/get</div>\n                                <div class=\"item-data-row__description\">Retrieve transactions for credit and depository accounts.</div>\n                            </div>\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-transactions-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-transactions-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                        <!-- Identity -->\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Identity</div>\n                                <div class=\"item-data-row__endpoint\">/identity/get</div>\n                                <div class=\"item-data-row__description\">Retrieve Identity information on file with the bank. Reduce fraud by comparing user-submitted data to validate identity.</div>\n                            </div>\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-identity-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-identity-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                        <!-- Balance -->\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Balance</div>\n                                <div class=\"item-data-row__endpoint\">/accounts/balance/get</div>\n                                <div class=\"item-data-row__description\">Check balances in real time to prevent non-sufficient funds fees.</div>\n                            </div>\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-balance-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-balance-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                        <!-- Holdings -->\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Holdings</div>\n                                <div class=\"item-data-row__endpoint\">/investments/holdings/get</div>\n                                <div class=\"item-data-row__description\">Retrieve investment holdings on file with the bank, brokerage, or investment institution. Analyze over-exposure to market segments.</div>\n                            </div>\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-holdings-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-holdings-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                        <!-- Investment Transactions -->\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Investment Transactions</div>\n                                <div class=\"item-data-row__endpoint\">/investments/transactions/get</div>\n                                <div class=\"item-data-row__description\">Retrieve investment transactions to analyze cash flow and trading performance.</div>\n                            </div>\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-investment-transactions-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-investment-transactions-data\"></tbody></table>\n                            </div>\n                        </div>\n\n\n\n                        <!-- Assets (hidden unless 'assets' is included in the product list) -->\n                        <div id='assets' class=\"item-data-row\" style='display:none;'>\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__nicename\">Assets</div>\n                                <div class=\"item-data-row__endpoint\">/asset_report/*</div>\n                                <div class=\"item-data-row__description\">Create a point-in-time snapshot of a user's assets.</div>\n                            </div>\n\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-assets-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n\n                                <a id=\"download-assets-pdf-btn\" class=\"button button--is-small button--is-primary button--is-full-width\" style=\"display: none; margin: 10px 0px;\">Download as PDF</a>\n                            </div>\n\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-assets-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                    </div>\n\n                    <div class=\"box\">\n                        <h3 class=\"box__heading\">Item management</h3>\n\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__endpoint\">/item/get</div>\n                                <div class=\"item-data-row__description\">Retrieve information about an Item, like the institution, billed products, available products, and webhook information.</div>\n                            </div>\n\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-item-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-item-data\"></tbody></table>\n                            </div>\n                        </div>\n\n                        <div class=\"item-data-row\">\n                            <div class=\"item-data-row__left\">\n                                <div class=\"item-data-row__request-type\">post</div>\n                            </div>\n                            <div class=\"item-data-row__center\">\n                                <div class=\"item-data-row__endpoint\">/accounts/get</div>\n                                <div class=\"item-data-row__description\">Retrieve high-level information about all accounts associated with an Item.</div>\n                            </div>\n\n                            <div class=\"item-data-row__right\">\n                                <button id=\"get-accounts-btn\" class=\"button button--is-small button--is-default button--is-full-width\">Send request</button>\n                            </div>\n\n                            <div class=\"item-data-row__response\">\n                                <table><tbody id=\"get-accounts-data\"></tbody></table>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </main>\n</template>\n<script>\n    (function($) {\n        var products = '<%= PLAID_PRODUCTS %>'.split(',');\n        if (products.includes('assets')) {\n            $('#assets').show();\n        }\n\n        var handler = Plaid.create({\n            apiVersion: 'v2',\n            clientName: 'Plaid Quickstart',\n            env: '<%= PLAID_ENV %>',\n            product: products,\n            key: '<%= PLAID_PUBLIC_KEY %>',\n            countryCodes: '<%= PLAID_COUNTRY_CODES %>'.split(','),\n            // webhook: 'https://your-domain.tld/plaid-webhook',\n            onSuccess: function(public_token) {\n                $.post('/get_access_token', {\n                    public_token: public_token\n                }, function(data) {\n                    $('#container').fadeOut('fast', function() {\n                        $('#item_id').text(data.item_id);\n                        $('#access_token').text(data.access_token);\n                        $('#intro').hide();\n                        $('#app, #steps').fadeIn('slow');\n                    });\n                });\n            },\n        });\n        var accessToken = qs('access_token');\n        if (accessToken != null && accessToken != '') {\n            $.post('/set_access_token', {\n                access_token: accessToken\n            }, function(data) {\n                $('#container').fadeOut('fast', function() {\n                    $('#item_id').text(data.item_id);\n                    $('#access_token').text(accessToken);\n                    $('#intro').hide();\n                    $('#app, #steps').fadeIn('slow');\n                });\n            });\n        }\n\n        $('#link-btn').on('click', function(e) {\n            handler.open();\n        });\n\n        $('#get-accounts-btn').on('click', function(e) {\n            $.get('/accounts', function(data) {\n\n                $('#get-accounts-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    var html = '<tr><td><strong>Name</strong></td><td><strong>Balances</strong></td><td><strong>Subtype</strong></td><td><strong>Mask</strong></td></tr>';\n                    data.accounts.accounts.forEach(function(account, idx) {\n                        console.log(account);\n                        html += '<tr>';\n                        html += '<td>' + account.name + '</td>';\n                        html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>';\n                        html += '<td>' + account.subtype + '</td>';\n                        html += '<td>' + account.mask + '</td>';\n                        html += '</tr>';\n                    });\n\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n\n        $('#get-auth-btn').on('click', function(e) {\n            $.get('/auth', function(data) {\n                $('#get-auth-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    var authData = data.auth;\n                    var isAch = authData.numbers.ach.length > 0;\n                    var routingLabel = isAch ? 'Routing #' : 'Institution and Branch #';\n\n                    var html = '<tr><td><strong>Name</strong></td><td><strong>Balance</strong></td><td><strong>Account #</strong></td><td><strong>'+ routingLabel +'</strong></td></tr>';\n                    if (isAch) {\n                        authData.numbers.ach.forEach(function(achNumbers, idx) {\n                            // Find the account associated with this set of account and routing numbers\n                            var account = authData.accounts.filter(function(a) {\n                                return a.account_id == achNumbers.account_id;\n                            })[0];\n                            console.log(account);\n                            html += '<tr>';\n                            html += '<td>' + account.name + '</td>';\n                            html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>';\n                            html += '<td>' + achNumbers.account + '</td>';\n                            html += '<td>' + achNumbers.routing + '</td>';\n                            html += '</tr>';\n                        });\n                    } else {\n                        authData.numbers.eft.forEach(function(eftNumber, idx) {\n                            // Find the account associated with this set of account and routing numbers\n                            var account = authData.accounts.filter(function(a) {\n                                return a.account_id == eftNumber.account_id;\n                            })[0];\n                            console.log(account);\n                            html += '<tr>';\n                            html += '<td>' + account.name + '</td>';\n                            html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>';\n                            html += '<td>' + eftNumber.account + '</td>';\n                            html += '<td>' + eftNumber.institution + ' ' + eftNumber.branch + '</td>';\n                            html += '</tr>';\n                        });\n                    }\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n\n        $('#get-identity-btn').on('click', function(e) {\n            $.get('/identity', function(data) {\n                $('#get-identity-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    var identityData = data.identity.identity;\n                    var html = '<tr class=\"response-row response-row--is-identity\"><td><strong>Names</strong></td><td><strong>Emails</strong></td><td><strong>Phone numbers</strong></td><td><strong>Addresses</strong></td></tr><tr class=\"response-row response-row--is-identity\">';\n                    html += '<td>';\n                    identityData.names.forEach(function(name, idx) {\n                        html += name + '<br />';\n                    });\n                    html += '</td><td>';\n                    identityData.emails.forEach(function(email, idx) {\n                        html += email.data + '<br />';\n                    });\n                    html += '</td><td>';\n                    identityData.phone_numbers.forEach(function(number, idx) {\n                        html += number.data + '<br />';\n                    });\n                    html += '</td><td>';\n                    identityData.addresses.forEach(function(address, idx) {\n                        html += address.data.street + '<br />';\n                        html += address.data.city + ', ' + address.data.state + ' ' + address.data.zip;\n                    });\n                    html += '</td></tr>';\n\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n\n        $('#get-item-btn').on('click', function(e) {\n            $.get('/item', function(data) {\n                $('#get-item-data').slideUp(function() {\n                    if (data.error) {\n                        displayError(this, data.error);\n                    } else {\n                        var html = '';\n                        html += '<tr><td>Institution name</td><td>' + data.institution.name + '</td></tr>';\n                        html += '<tr><td>Billed products</td><td>' + data.item.billed_products.join(', ') + '</td></tr>';\n                        html += '<tr><td>Available products</td><td>' + data.item.available_products.join(', ') + '</td></tr>';\n\n                        $(this).html(html).slideDown();\n                    }\n                });\n            });\n        });\n\n        $('#get-transactions-btn').on('click', function(e) {\n            $.get('/transactions', function(data) {\n                if (data.error != null && data.error.error_code != null) {\n                    // Format the error\n                    var errorHtml = '<div class=\"inner\"><p>' +\n                        '<strong>' + data.error.error_code + ':</strong> ' +\n                        (data.error.display_message == null ? data.error.error_message : data.error.display_message)  + '</p></div>';\n\n                    if (data.error.error_code === 'PRODUCT_NOT_READY') {\n                        // Add additional context for `PRODUCT_NOT_READY` errors\n                        errorHtml += '<div class=\"inner\"><p>Note: The PRODUCT_NOT_READY ' +\n                            'error is returned when a request to retrieve Transaction data ' +\n                            'is made before Plaid finishes the <a href=\"https://plaid.com/' +\n                            'docs/quickstart/#transaction-data-with-webhooks\">initial ' +\n                            'transaction pull.</a></p></div>';\n                    }\n                    // Render the error\n                    $('#get-transactions-data').slideUp(function() {\n                        $(this).slideUp(function() {\n                            $(this).html(errorHtml).slideDown();\n                        });\n                    });\n                } else {\n                    $('#get-transactions-data').slideUp(function() {\n                        var html = '<tr><td><strong>Name</strong></td><td><strong>Amount</strong></td><td><strong>Date</strong></td></tr>';\n                        data.transactions.transactions.forEach(function(txn, idx) {\n                            console.log(txn);\n                            html += '<tr>';\n                            html += '<td>' + txn.name + '</td>';\n                            html += '<td>$' + txn.amount + '</td>';\n                            html += '<td>' + txn.date + '</td>';\n                            html += '</tr>';\n                        });\n\n                        $(this).slideUp(function() {\n                            $(this).html(html).slideDown();\n                        });\n                    });\n                }\n            });\n        });\n\n        $('#get-balance-btn').on('click', function(e) {\n            $.get('/balance', function(data) {\n                $('#get-balance-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    var balanceData = data.balance;\n                    var html = '<tr><td><strong>Name</strong></td><td><strong>Balance</strong></td><td><strong>Subtype</strong></td><td><strong>Mask</strong></td></tr>';\n                    balanceData.accounts.forEach(function(account, idx) {\n                        console.log(account)\n                        html += '<tr>';\n                        html += '<td>' + account.name + '</td>';\n                        html += '<td>$' + (account.balances.available != null ? account.balances.available : account.balances.current) + '</td>'\n                        html += '<td>' + account.subtype + '</td>';\n                        html += '<td>' + account.mask + '</td>';\n                        html += '</tr>';\n                    });\n\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n\n        $('#get-holdings-btn').on('click', function(e) {\n            $.get('/holdings', function(data) {\n                $('#get-holdings-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    // Organize by Account\n                    var holdingsData = data.holdings.holdings.sort(function(a, b) {\n                        if (a.account_id > b.account_id) return 1;\n                        return -1;\n                    });\n                    var html = '<tr class=\"response-row response-row--is-holdings\"></tr><td><strong>Account Mask</strong></td><td><strong>Name</strong></td><td><strong>Quantity</strong></td><td><strong>Close Price</strong></td><td><strong>Value</strong></td><tr class=\"response-row response-row--is-holding\">';\n                    holdingsData.forEach(function(h, idx) {\n                        const account = data.holdings.accounts.filter(a => a.account_id === h.account_id)[0];\n                        const security = data.holdings.securities.filter(s => s.security_id === h.security_id)[0];\n                        if (account == null) {\n                            displayError(this, {\n                                code: 500,\n                                type: 'Internal',\n                                display_message: 'Holding lacks a account',\n                            });\n                        }\n                        if (security == null) {\n                            displayError(this, {\n                                code: 500,\n                                type: 'Internal',\n                                display_message: 'Holding lacks a security',\n                            });\n                        }\n                        html += '<tr>';\n                        html += '<td>' + account.mask + '</td>';\n                        html += '<td>' + security.name + '</td>';\n                        html += '<td>' + h.quantity + '</td>';\n                        html += '<td>$' + security.close_price + '</td>';\n                        html += '<td>$' + h.quantity * security.close_price + '</td>';\n                        html += '</tr>';\n                    });\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n\n        $('#get-investment-transactions-btn').on('click', function(e) {\n            $.get('/investment_transactions', function(data) {\n                $('#get-investment-transactions-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    investmentTransactionData = data.investment_transactions.investment_transactions;\n                    var html = '<tr class=\"response-row response-row--is-investment-transactions\"></tr><td><strong>Name</strong></td><td><strong>Amount</strong></td><td><strong>Date</strong></td><tr class=\"response-row response-row--is-investment-transaction\">';\n                    investmentTransactionData.forEach(function(invTxn, idx) {\n                        html += '<tr>';\n                        html += '<td>' + invTxn.name + '</td>';\n                        html += '<td>$' + invTxn.amount + '</td>';\n                        html += '<td>' + invTxn.date + '</td>';\n                        html += '</tr>';\n                    });\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n\n        $('#get-assets-btn').on('click', function(e) {\n            $.get('/assets', function(data) {\n                $('#get-assets-data').slideUp(function() {\n                    if (data.error != null) {\n                        displayError(this, data.error);\n                        return;\n                    }\n                    var reportData = data.json;\n                    var html = `\n          <tr>\n            <td><strong>Account</strong></td>\n            <td><strong>Balance</strong></td>\n            <td><strong># Transactions</strong></td>\n            <td><strong># Days Available</strong></td>\n          </tr>`;\n                    reportData.items.forEach(function(item, itemIdx) {\n                        item.accounts.forEach(function(account, accountIdx) {\n                            html += '<tr>';\n                            html += '<td>' + account.name + '</td>';\n                            html += '<td>$' + account.balances.current + '</td>'\n                            html += '<td>' + account.transactions.length + '</td>';\n                            html += '<td>' + account.days_available + '</td>';\n                            html += '</tr>';\n                        });\n                    });\n\n                    $('#download-assets-pdf-btn')\n                        .attr('href', `data:application/pdf;base64,${data.pdf}`)\n                        .attr('download', 'Asset Report.pdf')\n                        .show();\n\n                    $(this).html(html).slideDown();\n                });\n            });\n        });\n    })(jQuery);\n\n    function qs(key) {\n        key = key.replace(/[*+?^$.\\[\\]{}()|\\\\\\/]/g, \"\\\\$&\"); // escape RegEx meta chars\n        var match = location.search.match(new RegExp(\"[?&]\"+key+\"=([^&]+)(&|$)\"));\n        return match && decodeURIComponent(match[1].replace(/\\+/g, \" \"));\n    }\n\n    function displayError(element, error) {\n        var html = `\n    <div class=\"alert alert-danger\">\n      <p><strong>Error Code:</strong> ${error.error_code}</p>\n      <p><strong>Error Type:</strong> ${error.error_type}</p>\n      <p><strong>Error Message:</strong> ${error.display_message == null ? error.error_message : error.display_message}</p>\n      <div>Check out our <a href=\"https://plaid.com/docs/#errors-overview\">errors documentation</a> for more information.</div>\n    </div>`;\n        $(element).html(html).slideDown();\n    }\n</script>\n"]}]}